# MatchTimeChat

## Сборка
```shell
docker-compose up --build
```

## Описание компонентов проекта:

**Controller**
Контроллеры (Controllers) в Spring являются связующим звеном между клиентскими запросами (например, HTTP-запросами) и бизнес-логикой, реализованной в сервисах. Контроллеры принимают входящие HTTP-запросы, обрабатывают их (например, извлекают данные из тела запроса или URL) и передают соответствующие данные в сервисы для выполнения бизнес-логики. Затем они возвращают ответ (например, объект или статус) клиенту.

В проекте:

- `AuthController`: Управляет процессом аутентификации и регистрации пользователей.
- `ChatController`: Обрабатывает запросы, связанные с чатами, такими как создание чата, добавление участников и получение всех участников чата.
- `MessageController`: Управляет запросами, связанными с отправкой и получением сообщений.
- `UserController`: Обрабатывает запросы, связанные с пользователями, такими как создание, обновление, удаление и получение пользователей.

**DTO (Data Transfer Object)**
DTO — это объект, предназначенный для передачи данных между слоями приложения, обычно между контроллером и сервисом. DTO используется для упрощения работы с данными, которые могут быть избыточными или сложными для прямого использования. В Spring DTO используются для упрощения сериализации/десериализации данных (например, для работы с JSON).

В проекте:

- `AddParticipantDTO`: DTO для добавления участника в чат.
- `AuthResponseDTO`: DTO для передачи информации о статусе аутентификации.
- `CreateChatDTO`: DTO для создания чата, содержащее данные, необходимые для создания чата.
- `LoginDTO`: DTO для входа пользователя, включающее email и пароль.
- `RegisterDTO`: DTO для регистрации пользователя, включающее имя, email, пароль и т.д.
- `SendMessageDTO`: DTO для отправки сообщений.
- `UserDTO`: DTO для создания/обновления пользователя, включающее данные о пользователе, такие как email, имя, фамилия и пароль.

**Exception**
Классы обработки исключений (Exception) используются для обработки ошибок, которые могут возникнуть во время выполнения приложения. В Spring можно создать глобальные обработчики ошибок с помощью аннотации `@ControllerAdvice`, чтобы перехватывать исключения, возникающие в контроллерах, и возвращать соответствующие HTTP-статусы и сообщения.

В проекте:

- `UserExceptionHandler`: Обрабатывает исключения, связанные с пользователями.

**Model**
Модели (Models) в Spring представляют собой объекты, которые соответствуют сущностям базы данных (таблицам). Они часто аннотируются с использованием `@Entity`, что указывает на то, что объект является сущностью для сохранения в базе данных. Модели также могут содержать дополнительные методы, которые представляют поведение данных.

В проекте:

- `Chat`: Сущность, представляющая чат. Может содержать поля для имени чата, даты создания и ссылки на создателя.
- `ChatParticipant`: Связующая сущность между пользователем и чатом, представляющая участие пользователя в чате.
- `Message`: Сущность, представляющая сообщение. Включает текст сообщения, отправителя, время отправки и идентификатор чата.
- `User`: Сущность, представляющая пользователя. Содержит данные, такие как email, имя, фамилия и т.д.

**Repository**
Репозитории (Repositories) предоставляют интерфейсы для взаимодействия с базой данных. В Spring они часто наследуют интерфейс `JpaRepository`, который автоматически предоставляет стандартные методы для CRUD (Create, Read, Update, Delete) операций. Репозитории позволяют работать с сущностями без необходимости писать SQL-запросы вручную.

В проекте:

- `ChatParticipantRepository`: Интерфейс для работы с участниками чатов.
- `ChatRepository`: Интерфейс для работы с таблицей чатов.
- `MessageRepository`: Интерфейс для работы с таблицей сообщений.
- `UserRepository`: Интерфейс для работы с таблицей пользователей, предоставляет методы для поиска и сохранения пользователей.

**Service**
Сервисы (Services) содержат бизнес-логику приложения и выполняют обработку данных, полученных из репозиториев. Сервисы не зависят от веб-слоя и могут быть использованы независимо от него. Обычно сервисы вызываются из контроллеров, чтобы выполнять операции, такие как создание, обновление и удаление данных.

В проекте:

- `AuthService`: Сервис для обработки логики, связанной с аутентификацией и регистрацией.
- `ChatService`: Сервис для обработки логики, связанной с чатами и участниками чатов.
- `MessageService`: Сервис для обработки логики, связанной с сообщениями.
- `UserService`: Сервис для обработки логики, связанной с пользователями, например, создание пользователя, обновление и удаление.

**Config**
Классы конфигурации используются для настройки приложений. В проекте используются конфигурации для работы с JWT-токенами и безопасностью:

- `JwtAuthenticationFilter`: Фильтр для обработки JWT-токенов.
- `JwtTokenProvider`: Утилита для генерации и валидации JWT-токенов.
- `SecurityConfig`: Конфигурация безопасности приложения.

### Описание эндпоинтов

1. **Authentication Endpoints**

- **`POST /api/auth/register`**: Регистрирует нового пользователя.
- **`POST /api/auth/login`**: Выполняет аутентификацию пользователя и возвращает JWT-токен.

2. **Chat Endpoints**

- **`POST /api/chats`**: Создает новый чат. Принимает тело с данными для чата (например, название чата и ID пользователя, создающего чат).
- **`POST /api/chats/{chatId}/participants`**: Добавляет участника в чат. Принимает тело с ID пользователя, которого нужно добавить в чат.
- **`GET /api/chats/{chatId}/participants`**: Получает список всех участников чата.

3. **User Endpoints**

- **`GET /api/users`**: Получает список всех пользователей.
- **`POST /api/users`**: Создает нового пользователя. Принимает тело с данными пользователя (email, имя, роль и пароль).
- **`GET /api/users/{id}`**: Получает пользователя по ID.
- **`PUT /api/users/{id}`**: Обновляет информацию о пользователе по ID.
- **`DELETE /api/users/{id}`**: Удаляет пользователя по ID.

4. **Message Endpoints**

- **`GET /api/messages/chat/{chatId}`**: Получает список всех сообщений для чата по `chatId`. Сообщения возвращаются отсортированными по времени отправки в порядке возрастания.
- **`POST /api/messages`**: Отправляет новое сообщение в чат. Принимает тело с данными сообщения (текст, `chatId`, отправитель).
- **`GET /api/messages/{id}`**: Получает сообщение по его ID.
- **`DELETE /api/messages/{id}`**: Удаляет сообщение по его ID.

[Postman запросы](MatchTimeChat.postman_collection.json)
